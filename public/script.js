document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("order-form");e&&e.addEventListener("submit",function(e){e.preventDefault();const t=new URLSearchParams(window.location.search),n=decodeURIComponent(t.get("plan"))||"မระบุ",o="new"===t.get("user")?"New User":"Old User (သက်တမ်းတိုး)",d={plan:n,userType:o,userName:document.getElementById("user-name").value,contactPhone:document.getElementById("contact-phone").value,paymentMethod:document.querySelector('input[name="payment"]:checked').value,senderName:document.getElementById("sender-name").value,txnId:document.getElementById("txn-id").value,note:document.getElementById("note").value||"မရှိပါ"},s=form.querySelector(".submit-button");s.disabled=!0,s.textContent="Sending...",fetch("/api/submit-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)}).then(e=>e.json()).then(e=>{e.success?(alert("သင်၏ Order ကိုအောင်မြင်စွာလက်ခံရရှိပါသည်။ မကြာမီဆက်သွယ်ပေးပါမည်။"),form.reset(),document.getElementById("wave").dispatchEvent(new Event("change"))):alert("Error ဖြစ်နေပါသည်။ နောက်တစ်ကြိမ် ထပ်ကြိုးစားပေးပါ။")}).catch(e=>{alert("Network Error ဖြစ်နေပါသည်။ Internet ချိတ်ဆက်မှုကိုစစ်ဆေးပြီး နောက်တစ်ကြိမ်ထပ်ကြိုးစားပါ။")}).finally(()=>{s.disabled=!1,s.textContent="Confirm"})})});
